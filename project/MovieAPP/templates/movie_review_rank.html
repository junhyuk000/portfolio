{% extends "movie_base.html" %}

{% block css %}
<style>
    /* a íƒœê·¸ ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
    a {
        color: inherit; /* âœ… ë¶€ëª¨ ìš”ì†Œì˜ ê¸°ë³¸ ê¸€ììƒ‰ì„ ê·¸ëŒ€ë¡œ ì‚¬ìš© */
        text-decoration: none; /* âœ… ë°‘ì¤„ ì œê±° */
        transition: color 0.3s ease-in-out; /* âœ… ë¶€ë“œëŸ¬ìš´ ìƒ‰ìƒ ë³€ê²½ íš¨ê³¼ */
    }

    /* a íƒœê·¸ hover ì‹œ ìƒ‰ìƒ ë³€ê²½ */
    a:hover {
        color: #dda15e; /* âœ… ë§ˆìš°ìŠ¤ë¥¼ ì˜¬ë¦¬ë©´ ìƒ‰ìƒì´ ë³€ê²½ë¨ */
    }
    .podium {
        display: flex;
        justify-content: center;
        align-items: flex-end;
        height: 300px;
        margin-top: 0%;
    }

    .podium-item {
        width: 100px;
        text-align: center;
        margin: 0 20px;
        position: relative;
        border-radius: 10px;
        box-shadow: 8px 8px 10px rgba(0, 0, 0, 0.5); /* âœ… ì˜¤ë¥¸ìª½ ì•„ë˜ ê·¸ë¦¼ì */
        transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
    }

    /* âœ… ë§ˆìš°ìŠ¤ ì˜¤ë²„ ì‹œ ì‚´ì§ ë” ê°•ì¡° */
    .podium-item:hover {
        transform: scale(1.05);
        box-shadow: 10px 10px 14px rgba(0, 0, 0, 0.6); /* âœ… ë§ˆìš°ìŠ¤ ì˜¬ë¦¬ë©´ ì¡°ê¸ˆ ë” ì§„í•œ ê·¸ë¦¼ì */
    }

    .podium-item:first-child { background-color: silver; }
    .podium-item:nth-child(2) { background-color: gold; }
    .podium-item:nth-child(3) { background-color: #cd7f32; }

    .podium-item .medal {
        font-size: 50px;
        color: black;
        font-weight: bold;
        position: absolute;
        top: -70px;
        left: 50%;
        transform: translateX(-50%);
    }

    .podium-item .name {
        font-size: 20px;
        font-weight: bold;
        color: black;
        margin-top: 10px;
    }

    .podium-item .name a {
        color: #283618;
        text-decoration: none;
        font-weight: bold;
    }

    .podium-item .rank { 
        font-size: 18px; 
        color: white; 
        margin-top: 5px; 
    }

    .first { height: 180px; width: 200px; }
    .second { height: 140px; width: 200px; }
    .third { height: 100px; width: 200px; }


    .button-container {
        display: flex;
        justify-content: center;
        gap: 10px;
        margin-top: 10px;
    }

    /* âœ… í…Œì´ë¸”ì„ ê°ì‹¸ëŠ” ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼ */
    .ranking-table-container {
        display: flex;
        justify-content: center;
        margin-top: 20px;
        overflow-x: auto; /* âœ… ëª¨ë°”ì¼ì—ì„œ ê°€ë¡œ ìŠ¤í¬ë¡¤ ê°€ëŠ¥í•˜ê²Œ ì„¤ì • */
        width: 100%; /* âœ… ë¶€ëª¨ ìš”ì†Œì˜ í¬ê¸°ì— ë§ì¶¤ */
    }

    /* âœ… í‘œ ìŠ¤íƒ€ì¼ */
    .ranking-table {
        width: 80%;
        height: 70%;
        border-collapse: collapse;
        text-align: center;
        margin: auto;
        min-width: 700px; /* âœ… ìµœì†Œ ë„ˆë¹„ ì„¤ì • */
    }

    /* âœ… í…Œì´ë¸” í—¤ë” & ì…€ ìŠ¤íƒ€ì¼ */
    .ranking-table th, .ranking-table td {
        border: 1px solid #ddd;
        padding: 8px;
        white-space: nowrap; /* âœ… ì¤„ë°”ê¿ˆ ë°©ì§€ */
        padding: 10px;
    }

    .ranking-table th {
        background-color: #283618;
        color: white;
    }

    .ranking-table td {
        color: black;
    }

    /* âœ… ëª¨ë°”ì¼ì—ì„œ í‘œ í¬ê¸° ì¡°ì • */
    @media (max-width: 768px) {
        .ranking-table {
            font-size: 12px; /* âœ… ëª¨ë°”ì¼ì—ì„œ í°íŠ¸ í¬ê¸° ì¤„ì´ê¸° */
            min-width: 600px; /* âœ… ìµœì†Œ ë„ˆë¹„ ì¡°ì • */
        }

        .ranking-table th, .ranking-table td {
            padding: 6px; /* âœ… ì—¬ë°± ì¤„ì´ê¸° */
        }
    }


    h1 { font-size: 2.5rem; color:  #bc6c25; margin-bottom: 10px; }
</style>
{% endblock %}

{% block content %}
<div class="text-center">
    <h2 class="mb-4" id="ranking-title">ğŸ‘ ì¶”ì²œìˆ˜</h1>
    <div class="button-container">
        <button class="btn btn-outline-light" onclick="updateRank('top_recommend', 'ğŸ‘ ì¶”ì²œìˆ˜')" style="color: #ad7b67;">ì¶”ì²œìˆ˜</button>
        <button class="btn btn-outline-light" onclick="updateRank('top_views', 'ğŸ‘“ ì¡°íšŒìˆ˜')" style="color: #ad7b67;">ì¡°íšŒìˆ˜</button>
        <button class="btn btn-outline-light" onclick="updateRank('top_comments', 'ğŸ’¬ ëŒ“ê¸€ìˆ˜')" style="color: #ad7b67;">ëŒ“ê¸€ìˆ˜</button>
    </div>
    <div class="row">
        <div class="podium">
            <div id="second" class="podium-item second">
                <div class="medal">ğŸ¥ˆ</div>
                <div class="name"><a href="#" id="second-user"></a></div>
                <div class="rank">2nd</div>
                <div class="rank">ğŸ¿30ê°œ</div>
                
            </div>
            <div id="first" class="podium-item first">
                <div class="medal">ğŸ¥‡</div>
                <div class="name"><a href="#" id="first-user"></a></div>
                <div class="rank">1st</div>
                <div class="rank">ğŸ¿50ê°œ</div>
            </div>
            <div id="third" class="podium-item third">
                <div class="medal">ğŸ¥‰</div>
                <div class="name"><a href="#" id="third-user"></a></div>
                <div class="rank">3rd</div>
                <div class="rank">ğŸ¿10ê°œ</div>
            </div>
        </div>
    </div>

    <!-- ë§¤ì¶œì•¡ ìˆœìœ„ -->
    <div class="ranking-table-container">
        <table class="ranking-table" id="rankingTable">
            <thead>
                <tr>
                    <th>ìˆœìœ„</th>
                    <th>ìœ ì € ID</th>
                    <th>ì˜í™” ì œëª©</th>
                    <th>ë¦¬ë·° ì œëª©</th>
                    <th>ì¶”ì²œìˆ˜</th>
                    <th>ì¡°íšŒìˆ˜</th>
                    <th>ëŒ“ê¸€ìˆ˜</th>
                </tr>
            </thead>
            <tbody id="ranking-table-body"></tbody>
        </table>
    </div>


</div>
{% endblock %}

{% block js %}
<script>
    // íŒŒì´ì¬ì—ì„œ ë°›ì€ ë°ì´í„°
    const top_recommend = JSON.parse('{{ top_recommend | tojson | safe }}');
    const top_views = JSON.parse('{{ top_views | tojson | safe }}');
    const top_comments = JSON.parse('{{ top_comments | tojson | safe }}');

    // ê¸°ë³¸ ë°ì´í„° ì„¤ì •
    let currentData = top_recommend;

    // ìˆœìœ„ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
    function updateRank(type, titleText) {
        if (type === 'top_recommend') {
            currentData = top_recommend;
        } else if (type === 'top_views') {
            currentData = top_views;
        } else if (type === 'top_comments'){
            currentData = top_comments;
        }
        document.getElementById('ranking-title').textContent = titleText; // h1 ì œëª© ë³€ê²½
        updateTable();
        updatePodium();
    }

    // í…Œì´ë¸” ì—…ë°ì´íŠ¸
    function updateTable() {
        const tableBody = document.getElementById('rankingTable').querySelector('tbody');
        tableBody.innerHTML = '';

        currentData.forEach((item, index) => {
            const row = `<tr>
                <td>${index + 1}</td>
                <td><a href="/popcornapp/userinfo/${item.user_id}">${item.user_id}</a></td>
                <td><a href="/popcornapp/reviews/${item.movie_title}">${item.movie_title}</td>
                <td><a href="/popcornapp/post/${item.movie_title}/${item.id}">${item.title}</td>
                <td>${item.recommend}</td>
                <td>${item.views}</td>
                <td>${item.comments}</td>
            </tr>`;
            tableBody.innerHTML += row;
        });
    }

    // ì˜¬ë¦¼í”½ ìŠ¤íƒ€ì¼ ì—…ë°ì´íŠ¸
    function updatePodium() {
        if (currentData.length < 3) return;
        
        document.getElementById('first-user').textContent = currentData[0].user_id;
        document.getElementById('first-user').href = `/userinfo/${currentData[0].user_id}`;

        document.getElementById('second-user').textContent = currentData[1].user_id;
        document.getElementById('second-user').href = `/userinfo/${currentData[1].user_id}`;

        document.getElementById('third-user').textContent = currentData[2].user_id;
        document.getElementById('third-user').href = `/userinfo/${currentData[2].user_id}`;
    }

    // ì´ˆê¸° ë°ì´í„° ì„¤ì •
    updateTable();
    updatePodium();
</script>
{% endblock %}
